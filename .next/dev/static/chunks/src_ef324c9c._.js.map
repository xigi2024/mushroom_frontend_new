{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/mycomatrix/mushroom%20frontend/src/components/Sidebar.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useRouter, usePathname } from 'next/navigation';\r\nimport { FiHome, FiMonitor, FiPackage, FiUser, FiSettings, FiCreditCard, FiLogOut, FiMenu, FiX } from 'react-icons/fi';\r\nimport './styles/sidebar.css';\r\nimport Link from 'next/link';\r\n\r\n\r\nconst Sidebar = ({ activeSection, setActiveSection }) => {\r\n  const [userRole, setUserRole] = useState(\"user\");\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n  const [user, setUser] = useState(null);\r\n  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const userData = localStorage.getItem('user');\r\n    if (userData) {\r\n      setUser(JSON.parse(userData));\r\n      setUserRole(JSON.parse(userData)?.role?.toLowerCase() || \"user\");\r\n    }\r\n  }, []);\r\n\r\n  const adminSidebarItems = [\r\n    { id: 'dashboard', icon: FiHome, label: 'Admin Dashboard', path: '/admin-dashboard' },\r\n    { id: 'iot-monitoring', icon: FiMonitor, label: 'IoT Monitoring', path: '/admin/iot-monitoring' },\r\n    { id: 'products', icon: FiPackage, label: 'Products Order', path: '/admin/product-order' },\r\n    { id: 'accounts', icon: FiUser, label: 'Accounts', path: '/accounts' },\r\n    //{ id: 'settings', icon: FiSettings, label: 'Settings', path: '/settings' },\r\n    { id: 'payment', icon: FiCreditCard, label: 'Payment History', path: '/payment-history' }\r\n  ];\r\n\r\n  const userSidebarItems = [\r\n    { id: 'dashboard', icon: FiHome, label: 'User Dashboard', path: '/user-dashboard' },\r\n    { id: 'iot-monitoring', icon: FiMonitor, label: 'IoT Monitoring', path: '/user/iot-monitoring' },\r\n    { id: 'products', icon: FiPackage, label: 'Products Order', path: '/user/product-order' },\r\n    { id: 'profile', icon: FiUser, label: 'My Profile', path: '/profile' },\r\n    { id: 'payment', icon: FiCreditCard, label: 'My Payments', path: '/user-payments' }\r\n  ];\r\n\r\n  const sidebarItems = userRole === 'admin' ? adminSidebarItems : userSidebarItems;\r\n\r\n  // Set active section based on current path\r\n  useEffect(() => {\r\n    const currentItem = sidebarItems.find(item => item.path === pathname);\r\n    if (currentItem) {\r\n      setActiveSection(currentItem.id);\r\n    }\r\n  }, [pathname, sidebarItems, setActiveSection]);\r\n\r\n  // Close mobile menu when route changes\r\n  useEffect(() => {\r\n    setIsMobileMenuOpen(false);\r\n  }, [pathname]);\r\n\r\n  // Prevent body scroll when mobile menu is open\r\n  useEffect(() => {\r\n    if (isMobileMenuOpen) {\r\n      document.body.classList.add('mobile-menu-open');\r\n    } else {\r\n      document.body.classList.remove('mobile-menu-open');\r\n    }\r\n    return () => {\r\n      document.body.classList.remove('mobile-menu-open');\r\n    };\r\n  }, [isMobileMenuOpen]);\r\n\r\n  const handleNavigation = (item) => {\r\n    if (item.path) {\r\n      router.push(item.path);\r\n      setActiveSection(item.id);\r\n      setIsMobileMenuOpen(false);\r\n    }\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('access_token');\r\n    localStorage.removeItem('refresh_token');\r\n    localStorage.removeItem('user');\r\n    localStorage.removeItem('userRole');\r\n\r\n    // optional: remove guest cart\r\n    localStorage.removeItem('guest_cart');\r\n\r\n    router.push('/login');\r\n    window.location.reload(); // Force UI reset\r\n  };\r\n\r\n\r\n  const getUserInitials = () => {\r\n    if (!user) return 'U';\r\n    const { first_name } = user;\r\n    if (first_name) {\r\n      return first_name.charAt(0).toUpperCase();\r\n    }\r\n    return 'U';\r\n  };\r\n\r\n  const getUserDisplayName = () => {\r\n    if (!user) return 'User';\r\n    const { first_name, last_name } = user;\r\n    if (first_name && last_name) {\r\n      return `${first_name} ${last_name}`;\r\n    } else if (first_name) {\r\n      return first_name;\r\n    } else if (last_name) {\r\n      return last_name;\r\n    }\r\n    return user.email || 'User';\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Topbar */}\r\n      <div className=\"topbar\">\r\n        <div className=\"topbar-content\">\r\n          {/* Hamburger Menu for Mobile */}\r\n          <button\r\n            className=\"mobile-menu-toggle\"\r\n            onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}\r\n            aria-label=\"Toggle menu\"\r\n          >\r\n            {isMobileMenuOpen ? <FiX size={24} /> : <FiMenu size={24} />}\r\n          </button>\r\n\r\n          <h2 className=\"dashboard-title\">\r\n            {userRole === 'admin' ? 'Admin Dashboard' : 'User Dashboard'}\r\n          </h2>\r\n\r\n          <div className=\"topbar-right\">\r\n            <span className=\"welcome-text\">Welcome, {getUserDisplayName()}</span>\r\n            <div className=\"user-avatar\">{getUserInitials()}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Mobile Overlay */}\r\n      {isMobileMenuOpen && (\r\n        <div\r\n          className=\"mobile-overlay\"\r\n          onClick={() => setIsMobileMenuOpen(false)}\r\n        />\r\n      )}\r\n\r\n      {/* Sidebar */}\r\n      <div className={`sidebar ${isMobileMenuOpen ? 'mobile-open' : ''}`}>\r\n        <div className=\"sidebar-header\">\r\n          <Link href=\"/\">\r\n            <img\r\n              src=\"/assets/logo2.png\"\r\n              alt=\"Logo\"\r\n              className=\"img-fluid sidebar-logo\"\r\n            />\r\n          </Link>\r\n        </div>\r\n\r\n        <div className=\"sidebar-menu\">\r\n          {sidebarItems.map(item => (\r\n            <div\r\n              key={item.id}\r\n              className={`sidebar-item ${activeSection === item.id ? 'active' : ''}`}\r\n              onClick={() => handleNavigation(item)}\r\n            >\r\n              <item.icon className=\"sidebar-icon\" />\r\n              <span>{item.label}</span>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <div className=\"sidebar-footer\">\r\n          <div className=\"sidebar-item logout-item\" onClick={handleLogout}>\r\n            <FiLogOut className=\"sidebar-icon\" />\r\n            <span>Logout</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Sidebar;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 378, "column": 0}, "map": {"version":3,"sources":["file:///D:/mycomatrix/mushroom%20frontend/src/components/Layout.tsx"],"sourcesContent":["\"use client\";\r\nimport React from 'react';\r\nimport Sidebar from './Sidebar';\r\n\r\nconst Layout = ({ children, activeSection, setActiveSection, userRole }) => {\r\n  return (\r\n    <div className=\"dashboard-container\">\r\n      <Sidebar activeSection={activeSection} setActiveSection={setActiveSection} userRole={userRole} />\r\n      <div className=\"main-content\">\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Layout;\r\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIA,MAAM,SAAS,CAAC,EAAE,QAAQ,EAAE,aAAa,EAAE,gBAAgB,EAAE,QAAQ,EAAE;IACrE,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,2IAAO;gBAAC,eAAe;gBAAe,kBAAkB;gBAAkB,UAAU;;;;;;0BACrF,6LAAC;gBAAI,WAAU;0BACZ;;;;;;;;;;;;AAIT;KATM;uCAWS"}},
    {"offset": {"line": 426, "column": 0}, "map": {"version":3,"sources":["file:///D:/mycomatrix/mushroom%20frontend/src/components/pages/UserDashboard.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Container, Row, Col, Card, Table, Badge, ProgressBar, Button, Spinner, Alert } from 'react-bootstrap';\r\nimport { FiPackage, FiHome, FiTrendingUp, FiThermometer, FiDroplet, FiWind, FiSun, FiAlertTriangle } from 'react-icons/fi';\r\nimport { Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend } from 'chart.js';\r\nimport { Line } from 'react-chartjs-2';\r\nimport { useRouter } from 'next/navigation';\r\nimport '../styles/dashboard.css';\r\nimport Layout from '../Layout';\r\n\r\n// Register ChartJS components\r\nChartJS.register(\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend\r\n);\r\n\r\nconst UserDashboard = () => {\r\n  const router = useRouter();\r\n  const [activeSection, setActiveSection] = useState('dashboard');\r\n  const [iotData, setIotData] = useState({\r\n    temperature: 22,\r\n    humidity: 80\r\n  });\r\n\r\n  // State for rooms and orders data\r\n  const [rooms, setRooms] = useState([]);\r\n  const [allOrders, setAllOrders] = useState([]);\r\n  const [latestOrders, setLatestOrders] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n\r\n  // Chart data for sensor history\r\n  const [sensorHistory, setSensorHistory] = useState({\r\n    labels: Array(12).fill('').map((_, i) => {\r\n      const date = new Date();\r\n      date.setMinutes(date.getMinutes() - ((12 - i) * 5));\r\n      return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n    }),\r\n    temperature: Array(12).fill(22),\r\n    humidity: Array(12).fill(80),\r\n    lastUpdate: new Date()\r\n  });\r\n\r\n  // âœ… Check if user has ACTUALLY created rooms\r\n  const hasCreatedRooms = rooms && rooms.length > 0;\r\n\r\n  // Fetch user's rooms data\r\n  const fetchUserRooms = async () => {\r\n    try {\r\n      const token = localStorage.getItem('access_token');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('https://mycomatrix.in/api/rooms/my-rooms/', {\r\n        method: 'GET',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const roomsData = await response.json();\r\n        console.log('ðŸ  Fetched rooms data:', roomsData);\r\n\r\n        if (roomsData.success && roomsData.rooms && roomsData.rooms.length > 0) {\r\n          setRooms(roomsData.rooms);\r\n          console.log('âœ… User has created rooms:', roomsData.rooms.length);\r\n        } else {\r\n          setRooms([]);\r\n          console.log('âŒ User has NO rooms created');\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching rooms:', err);\r\n      setRooms([]);\r\n    }\r\n  };\r\n\r\n  // Fetch user orders\r\n  const fetchUserOrders = async () => {\r\n    try {\r\n      const token = localStorage.getItem('access_token');\r\n      if (!token) {\r\n        setError('Please login to view your orders');\r\n        return;\r\n      }\r\n\r\n      const response = await fetch('https://mycomatrix.in/api/orders/my-orders/', {\r\n        method: 'GET',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const ordersData = await response.json();\r\n\r\n        if (Array.isArray(ordersData)) {\r\n          setAllOrders(ordersData);\r\n          const sortedOrders = [...ordersData].sort((a, b) =>\r\n            new Date(b.created_at) - new Date(a.created_at)\r\n          );\r\n          const latestThree = sortedOrders.slice(0, 3);\r\n          setLatestOrders(latestThree);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching orders:', err);\r\n    }\r\n  };\r\n\r\n  // Calculate stats\r\n  const getTotalOrderedProducts = () => {\r\n    if (!Array.isArray(allOrders) || allOrders.length === 0) return 0;\r\n\r\n    let totalProducts = 0;\r\n    allOrders.forEach(order => {\r\n      if (order.items && Array.isArray(order.items)) {\r\n        order.items.forEach(item => {\r\n          totalProducts += item.qty || 1;\r\n        });\r\n      }\r\n    });\r\n\r\n    return totalProducts;\r\n  };\r\n\r\n  const getTotalOrdersCount = () => {\r\n    return Array.isArray(allOrders) ? allOrders.length : 0;\r\n  };\r\n\r\n  // Get REAL sensor data only if rooms exist\r\n  const getLatestSensorData = () => {\r\n    if (!hasCreatedRooms) {\r\n      return { temperature: 22, humidity: 80 }; // Default data\r\n    }\r\n\r\n    // Find the first room with actual sensor data\r\n    const roomWithData = rooms.find(room => room.latest_sensor_data);\r\n\r\n    if (roomWithData && roomWithData.latest_sensor_data) {\r\n      const sensorData = roomWithData.latest_sensor_data;\r\n      console.log('ðŸ“Š Using REAL sensor data:', sensorData);\r\n      return {\r\n        temperature: sensorData.temperature || 22,\r\n        humidity: sensorData.humidity || 80\r\n      };\r\n    }\r\n\r\n    // If rooms exist but no sensor data, use default\r\n    return { temperature: 22, humidity: 80 };\r\n  };\r\n\r\n  // Update sensor data only when rooms exist\r\n  useEffect(() => {\r\n    if (hasCreatedRooms) {\r\n      const sensorData = getLatestSensorData();\r\n      setIotData(sensorData);\r\n      console.log('ðŸ”„ Updated IoT data with room sensor data');\r\n    }\r\n  }, [rooms]);\r\n\r\n  // Update chart data\r\n  useEffect(() => {\r\n    const now = new Date();\r\n    const timeDiff = (now - sensorHistory.lastUpdate) / (1000 * 60);\r\n\r\n    if (timeDiff >= 5) {\r\n      setSensorHistory(prev => {\r\n        const newLabels = [...prev.labels.slice(1), now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })];\r\n        return {\r\n          ...prev,\r\n          labels: newLabels,\r\n          temperature: [...prev.temperature.slice(1), iotData.temperature],\r\n          humidity: [...prev.humidity.slice(1), iotData.humidity],\r\n          lastUpdate: now\r\n        };\r\n      });\r\n    }\r\n  }, [iotData, sensorHistory.lastUpdate]);\r\n\r\n  // Chart configuration\r\n  const chartData = {\r\n    labels: sensorHistory.labels,\r\n    datasets: [\r\n      {\r\n        label: 'Temperature (Â°C)',\r\n        data: sensorHistory.temperature,\r\n        borderColor: 'rgba(255, 99, 132, 1)',\r\n        backgroundColor: 'rgba(255, 99, 132, 0.2)',\r\n        tension: 0.4,\r\n        yAxisID: 'y',\r\n        pointRadius: 2,\r\n        borderWidth: 2\r\n      },\r\n      {\r\n        label: 'Humidity (%)',\r\n        data: sensorHistory.humidity,\r\n        borderColor: 'rgba(54, 162, 235, 1)',\r\n        backgroundColor: 'rgba(54, 162, 235, 0.2)',\r\n        tension: 0.4,\r\n        yAxisID: 'y1',\r\n        pointRadius: 2,\r\n        borderWidth: 2\r\n      }\r\n    ]\r\n  };\r\n\r\n  const chartOptions = {\r\n    responsive: true,\r\n    interaction: {\r\n      mode: 'index',\r\n      intersect: false,\r\n    },\r\n    plugins: {\r\n      legend: {\r\n        position: 'top',\r\n      }\r\n    },\r\n    scales: {\r\n      y: {\r\n        type: 'linear',\r\n        display: true,\r\n        position: 'left',\r\n        title: {\r\n          display: true,\r\n          text: 'Temperature (Â°C)'\r\n        },\r\n        min: 15,\r\n        max: 35,\r\n        grid: {\r\n          drawOnChartArea: false\r\n        }\r\n      },\r\n      y1: {\r\n        type: 'linear',\r\n        display: true,\r\n        position: 'right',\r\n        title: {\r\n          display: true,\r\n          text: 'Humidity (%)'\r\n        },\r\n        min: 50,\r\n        max: 100,\r\n        grid: {\r\n          drawOnChartArea: false\r\n        }\r\n      },\r\n      x: {\r\n        grid: {\r\n          display: false\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  // Initial data fetch\r\n  useEffect(() => {\r\n    setActiveSection('dashboard');\r\n\r\n    const fetchData = async () => {\r\n      setLoading(true);\r\n      await Promise.all([fetchUserRooms(), fetchUserOrders()]);\r\n      setLoading(false);\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  // Auto-update only if rooms exist\r\n  useEffect(() => {\r\n    if (!hasCreatedRooms) {\r\n      console.log('â¹ï¸ No rooms - stopping sensor updates');\r\n      return;\r\n    }\r\n\r\n    const updateSensorData = () => {\r\n      const currentData = getLatestSensorData();\r\n      setIotData(prev => ({\r\n        temperature: Math.round((currentData.temperature + (Math.random() - 0.5) * 2) * 10) / 10,\r\n        humidity: Math.max(60, Math.min(90, currentData.humidity + (Math.random() - 0.5) * 5))\r\n      }));\r\n    };\r\n\r\n    // Set up 5-minute interval only if user has rooms\r\n    const interval = setInterval(updateSensorData, 5 * 60 * 1000);\r\n    console.log('ðŸ”„ Started sensor updates for rooms');\r\n\r\n    return () => {\r\n      clearInterval(interval);\r\n      console.log('ðŸ›‘ Stopped sensor updates');\r\n    };\r\n  }, [hasCreatedRooms]);\r\n\r\n  // Helper functions\r\n  const formatLatestOrders = () => {\r\n    if (!Array.isArray(latestOrders) || latestOrders.length === 0) return [];\r\n    return latestOrders.flatMap(order => {\r\n      if (!order.items || order.items.length === 0) {\r\n        return [{\r\n          id: order.id,\r\n          order_id: `ORD-${String(order.id).padStart(3, '0')}`,\r\n          product: 'No items',\r\n          quantity: 0,\r\n          status: order.status || 'pending',\r\n          date: new Date(order.created_at).toLocaleDateString('en-IN'),\r\n          total_amount: order.total_amount || '0.00'\r\n        }];\r\n      }\r\n\r\n      return order.items.map(item => ({\r\n        id: order.id,\r\n        order_id: `ORD-${String(order.id).padStart(3, '0')}`,\r\n        product: item.product?.name || 'Product',\r\n        quantity: item.qty || 1,\r\n        status: order.status || 'pending',\r\n        date: new Date(order.created_at).toLocaleDateString('en-IN'),\r\n        total_amount: order.total_amount || '0.00'\r\n      }));\r\n    });\r\n  };\r\n\r\n  const displayLatestOrders = formatLatestOrders();\r\n\r\n  const getStatusBadge = (status) => {\r\n    const statusConfig = {\r\n      delivered: { variant: 'success', text: 'Delivered' },\r\n      completed: { variant: 'success', text: 'Completed' },\r\n      processing: { variant: 'warning', text: 'Processing' },\r\n      shipped: { variant: 'info', text: 'Shipped' },\r\n      pending: { variant: 'secondary', text: 'Pending' },\r\n      cancelled: { variant: 'danger', text: 'Cancelled' }\r\n    };\r\n    return statusConfig[status] || { variant: 'secondary', text: status };\r\n  };\r\n\r\n  const getOptimalStatus = (value, min, max) => {\r\n    if (value >= min && value <= max) return 'optimal';\r\n    if (value < min - 5 || value > max + 5) return 'critical';\r\n    return 'warning';\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout activeSection={activeSection} setActiveSection={setActiveSection} userRole=\"user\">\r\n        <div className=\"dashboard-content\">\r\n          <div className=\"text-center py-5\">\r\n            <Spinner animation=\"border\" variant=\"primary\" />\r\n            <p className=\"mt-2\">Loading dashboard...</p>\r\n          </div>\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout activeSection={activeSection} setActiveSection={setActiveSection} userRole=\"user\">\r\n      <div className=\"dashboard-content\">\r\n        {/* Stats Cards */}\r\n        <Row className=\"mb-4\">\r\n          <Col md={4}>\r\n            <Card className=\"stat-card\">\r\n              <Card.Body className=\"d-flex justify-content-between align-items-center\">\r\n                <div className=\"text-start\">\r\n                  <div className=\"stat-number\">{getTotalOrderedProducts()}</div>\r\n                  <div className=\"stat-label\">My Ordered Products</div>\r\n                  <small className=\"text-muted\">From {getTotalOrdersCount()} orders</small>\r\n                </div>\r\n                <div className=\"stat-icon\">\r\n                  <FiPackage className=\"color\" size={32} />\r\n                </div>\r\n              </Card.Body>\r\n            </Card>\r\n          </Col>\r\n          <Col md={4}>\r\n            <Card className=\"stat-card\">\r\n              <Card.Body className=\"d-flex justify-content-between align-items-center\">\r\n                <div className=\"text-start\">\r\n                  <div className=\"stat-number\">{rooms.length}</div>\r\n                  <div className=\"stat-label\">Total Rooms</div>\r\n                  <small className=\"text-muted\">\r\n                    {hasCreatedRooms ? `${rooms.length} rooms active` : 'No rooms created'}\r\n                  </small>\r\n                </div>\r\n                <div className=\"stat-icon text-info\">\r\n                  <FiHome size={32} />\r\n                </div>\r\n              </Card.Body>\r\n            </Card>\r\n          </Col>\r\n          <Col md={4}>\r\n            <Card className=\"stat-card\">\r\n              <Card.Body className=\"d-flex justify-content-between align-items-center\">\r\n                <div className=\"text-start\">\r\n                  <div className=\"stat-number\">{getTotalOrdersCount()}</div>\r\n                  <div className=\"stat-label\">Total Orders</div>\r\n                </div>\r\n                <div className=\"stat-icon text-success\">\r\n                  <FiTrendingUp size={32} />\r\n                </div>\r\n              </Card.Body>\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n\r\n        {/* âœ… UPDATED: Main Dashboard Row - Show charts ONLY when rooms exist */}\r\n        {hasCreatedRooms ? (\r\n          <Row>\r\n            {/* Chart Section - Only show when rooms exist */}\r\n            <Col md={6}>\r\n              <Card className=\"chart-card\">\r\n                <Card.Header className=\"d-flex justify-content-between align-items-center\">\r\n                  <h6 className=\"mb-0\">SENSOR DATA TREND</h6>\r\n                  <div className=\"d-flex align-items-center\">\r\n                    <div className=\"sensor-legend me-3\">\r\n                      <span className=\"sensor-dot\" style={{ backgroundColor: 'rgba(255, 99, 132, 1)' }}></span>\r\n                      <span className=\"ms-1\">Temp</span>\r\n                    </div>\r\n                    <div className=\"sensor-legend\">\r\n                      <span className=\"sensor-dot\" style={{ backgroundColor: 'rgba(54, 162, 235, 1)' }}></span>\r\n                      <span className=\"ms-1\">Humidity</span>\r\n                    </div>\r\n                  </div>\r\n                </Card.Header>\r\n                <Card.Body>\r\n                  <div style={{ height: '300px' }}>\r\n                    <Line data={chartData} options={chartOptions} />\r\n                  </div>\r\n                  <div className=\"mt-2 text-center\">\r\n                    <small className=\"text-muted\">\r\n                      Real-time sensor data from your rooms\r\n                    </small>\r\n                  </div>\r\n                </Card.Body>\r\n              </Card>\r\n            </Col>\r\n\r\n            {/* IoT Room Status - Only show when rooms exist */}\r\n            <Col md={6}>\r\n              <Card className=\"iot-card\">\r\n                <Card.Header className=\"d-flex justify-content-between align-items-center\">\r\n                  <h6 className=\"mb-0\">IoT Room Status</h6>\r\n                  <small className=\"text-muted\">Live Data</small>\r\n                </Card.Header>\r\n                <Card.Body>\r\n                  {/* Temperature */}\r\n                  <div className=\"iot-metric mb-3\">\r\n                    <div className=\"d-flex justify-content-between align-items-center mb-1\">\r\n                      <div className=\"d-flex align-items-center\">\r\n                        <FiThermometer className=\"me-2 text-danger\" />\r\n                        <span>Temperature</span>\r\n                      </div>\r\n                      <Badge bg={getOptimalStatus(iotData.temperature, 20, 26) === 'optimal' ? 'success' : 'warning'}>\r\n                        {getOptimalStatus(iotData.temperature, 20, 26)}\r\n                      </Badge>\r\n                    </div>\r\n                    <div className=\"metric-value\">{iotData.temperature}Â°C (Optimal: 22-26Â°C)</div>\r\n                    <ProgressBar\r\n                      now={(iotData.temperature / 30) * 100}\r\n                      variant={getOptimalStatus(iotData.temperature, 20, 26) === 'optimal' ? 'success' : 'warning'}\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Humidity */}\r\n                  <div className=\"iot-metric mb-3\">\r\n                    <div className=\"d-flex justify-content-between align-items-center mb-1\">\r\n                      <div className=\"d-flex align-items-center\">\r\n                        <FiDroplet className=\"me-2 text-info\" />\r\n                        <span>Humidity</span>\r\n                      </div>\r\n                      <Badge bg={getOptimalStatus(iotData.humidity, 75, 85) === 'optimal' ? 'success' : 'warning'}>\r\n                        {getOptimalStatus(iotData.humidity, 75, 85)}\r\n                      </Badge>\r\n                    </div>\r\n                    <div className=\"metric-value\">{iotData.humidity}% (Optimal: 80-90%)</div>\r\n                    <ProgressBar\r\n                      now={iotData.humidity}\r\n                      variant={getOptimalStatus(iotData.humidity, 75, 85) === 'optimal' ? 'success' : 'warning'}\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Room Status Summary */}\r\n                  <div className=\"mt-4 p-3 bg-light rounded\">\r\n                    <h6 className=\"mb-2\">Rooms Summary</h6>\r\n                    <div className=\"d-flex justify-content-between\">\r\n                      <small>Total Rooms: <strong>{rooms.length}</strong></small>\r\n                      <small>Active Sensors: <strong>{rooms.filter(room => room.latest_sensor_data).length}</strong></small>\r\n                    </div>\r\n                  </div>\r\n                </Card.Body>\r\n              </Card>\r\n            </Col>\r\n          </Row>\r\n        ) : (\r\n          // âœ… UPDATED: Empty state when NO rooms created - Show full width message\r\n          <Row>\r\n            <Col md={12}>\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <Card.Body className=\"text-center py-5\">\r\n                  <div className=\"text-muted mb-3\">\r\n                    <FiHome size={64} />\r\n                  </div>\r\n                  <h4 className=\"text-muted mb-3\">No Rooms Created Yet</h4>\r\n                  <p className=\"text-muted mb-4\" style={{ maxWidth: '800px', margin: '0 auto' }}>\r\n                    You haven't created any mushroom growing rooms yet. Create your first room in IoT Monitoring\r\n                    to start monitoring temperature, humidity, and get real-time sensor data for optimal mushroom growth conditions.\r\n                  </p>\r\n                  <Button\r\n                    className=\"button\"\r\n                    onClick={() => router.push(\"/iot-monitoring\")}\r\n                    size=\"lg\"\r\n                  >\r\n                    <FiHome className=\"me-2\" />\r\n                    Create Your First Room in IoT Monitoring\r\n                  </Button>\r\n                </Card.Body>\r\n              </Card>\r\n            </Col>\r\n          </Row>\r\n        )}\r\n\r\n        {/* Recent Orders Table - Always show orders section */}\r\n        <Row className=\"mt-4\">\r\n          <Col>\r\n            <Card>\r\n              <Card.Header className=\"d-flex justify-content-between align-items-center\">\r\n                <h6 className=\"mb-0\">My Recent Orders (Latest 3)</h6>\r\n                <Button className='button' onClick={() => router.push(\"/user/product-order\")}>View All</Button>\r\n              </Card.Header>\r\n              <Card.Body>\r\n                {displayLatestOrders.length === 0 ? (\r\n                  <div className=\"text-center py-4\">\r\n                    <p className=\"text-muted\">No recent orders found.</p>\r\n                  </div>\r\n                ) : (\r\n                  <Table responsive className=\"mb-0\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>Order ID</th>\r\n                        <th>Product</th>\r\n                        <th>Quantity</th>\r\n                        <th>Status</th>\r\n                        <th>Date</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {displayLatestOrders.map((order, index) => (\r\n                        <tr key={`${order.id}-${index}`}>\r\n                          <td><strong>{order.order_id}</strong></td>\r\n                          <td>\r\n                            <div>\r\n                              <div className=\"fw-semibold\">{order.product}</div>\r\n                              <small className=\"text-muted\">Order Total: â‚¹{order.total_amount}</small>\r\n                            </div>\r\n                          </td>\r\n                          <td>{order.quantity}</td>\r\n                          <td>\r\n                            <Badge bg={getStatusBadge(order.status).variant}>\r\n                              {getStatusBadge(order.status).text}\r\n                            </Badge>\r\n                          </td>\r\n                          <td>{order.date}</td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </Table>\r\n                )}\r\n              </Card.Body>\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n\r\n        {error && (\r\n          <Alert variant=\"warning\" className=\"mt-3\">\r\n            {error}\r\n          </Alert>\r\n        )}\r\n      </div>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default UserDashboard;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1810, "column": 0}, "map": {"version":3,"sources":["file:///D:/mycomatrix/mushroom%20frontend/src/components/ProtectedRoute.tsx"],"sourcesContent":["\"use client\";\r\n// src/components/ProtectedRoute.js\r\nimport React, { useEffect } from 'react';\r\nimport { useRouter, usePathname } from 'next/navigation';\r\nimport { useAuth } from '../context/AuthContext';\r\n\r\nconst ProtectedRoute = ({ children }) => {\r\n  const { isAuthenticated, loading, user } = useAuth();\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n\r\n  useEffect(() => {\r\n    console.log('ProtectedRoute - Auth state:', {\r\n      isAuthenticated,\r\n      loading,\r\n      hasToken: typeof window !== 'undefined' ? !!localStorage.getItem('access_token') : false,\r\n      user: user ? 'User exists' : 'No user',\r\n      timestamp: new Date().toISOString()\r\n    });\r\n  }, [isAuthenticated, loading, user]);\r\n\r\n  useEffect(() => {\r\n    if (!loading && !isAuthenticated) {\r\n      console.log('ProtectedRoute - Not authenticated, redirecting to login');\r\n      if (pathname !== '/login') {\r\n        localStorage.setItem('redirectAfterLogin', pathname);\r\n      }\r\n      router.push('/login');\r\n    }\r\n  }, [loading, isAuthenticated, pathname, router]);\r\n\r\n  if (loading) {\r\n    console.log('ProtectedRoute - Loading authentication state...');\r\n    return <div className=\"d-flex justify-content-center align-items-center vh-100\">\r\n      <div className=\"spinner-border text-primary\" role=\"status\">\r\n        <span className=\"visually-hidden\">Loading...</span>\r\n      </div>\r\n    </div>;\r\n  }\r\n\r\n  if (!isAuthenticated) {\r\n    return null; // Don't render anything while redirecting\r\n  }\r\n\r\n  console.log('ProtectedRoute - User authenticated, rendering children');\r\n  return children;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n"],"names":[],"mappings":";;;;;AACA,mCAAmC;AACnC;AACA;AACA;;;AAJA;;;;AAMA,MAAM,iBAAiB,CAAC,EAAE,QAAQ,EAAE;;IAClC,MAAM,EAAE,eAAe,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,IAAA,4IAAO;IAClD,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,WAAW,IAAA,oJAAW;IAE5B,IAAA,0KAAS;oCAAC;YACR,QAAQ,GAAG,CAAC,gCAAgC;gBAC1C;gBACA;gBACA,UAAU,uCAAgC,CAAC,CAAC,aAAa,OAAO,CAAC,kBAAkB;gBACnF,MAAM,OAAO,gBAAgB;gBAC7B,WAAW,IAAI,OAAO,WAAW;YACnC;QACF;mCAAG;QAAC;QAAiB;QAAS;KAAK;IAEnC,IAAA,0KAAS;oCAAC;YACR,IAAI,CAAC,WAAW,CAAC,iBAAiB;gBAChC,QAAQ,GAAG,CAAC;gBACZ,IAAI,aAAa,UAAU;oBACzB,aAAa,OAAO,CAAC,sBAAsB;gBAC7C;gBACA,OAAO,IAAI,CAAC;YACd;QACF;mCAAG;QAAC;QAAS;QAAiB;QAAU;KAAO;IAE/C,IAAI,SAAS;QACX,QAAQ,GAAG,CAAC;QACZ,qBAAO,6LAAC;YAAI,WAAU;sBACpB,cAAA,6LAAC;gBAAI,WAAU;gBAA8B,MAAK;0BAChD,cAAA,6LAAC;oBAAK,WAAU;8BAAkB;;;;;;;;;;;;;;;;IAGxC;IAEA,IAAI,CAAC,iBAAiB;QACpB,OAAO,MAAM,0CAA0C;IACzD;IAEA,QAAQ,GAAG,CAAC;IACZ,OAAO;AACT;GAxCM;;QACuC,4IAAO;QACnC,kJAAS;QACP,oJAAW;;;KAHxB;uCA0CS"}},
    {"offset": {"line": 1911, "column": 0}, "map": {"version":3,"sources":["file:///D:/mycomatrix/mushroom%20frontend/src/app/user-dashboard/page.tsx"],"sourcesContent":["\"use client\";\r\nimport UserDashboard from '../../components/pages/UserDashboard';\r\nimport Layout from '../../components/Layout';\r\nimport ProtectedRoute from '../../components/ProtectedRoute';\r\n\r\nexport default function UserDashboardPage() {\r\n    return (\r\n        <ProtectedRoute>\r\n            <Layout activeSection=\"dashboard\" setActiveSection={() => { }} userRole=\"user\">\r\n                <UserDashboard />\r\n            </Layout>\r\n        </ProtectedRoute>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAHA;;;;;AAKe,SAAS;IACpB,qBACI,6LAAC,kJAAc;kBACX,cAAA,6LAAC,0IAAM;YAAC,eAAc;YAAY,kBAAkB,KAAQ;YAAG,UAAS;sBACpE,cAAA,6LAAC,0JAAa;;;;;;;;;;;;;;;AAI9B;KARwB"}}]
}